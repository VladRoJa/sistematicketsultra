<!-- frontend-angular/src/app/pantalla-crear-ticket/pantalla-crear-ticket.component.html -->
<mat-card class="ticket-container-global">
  <h2>ğŸ« Crear Nuevo Ticket</h2>
  <form [formGroup]="formularioCrearTicket" (ngSubmit)="enviarTicket()" class="formulario-ticket-container">
    <!-- Departamento -->
<mat-form-field appearance="fill">
  <mat-label>ğŸ¢ Departamento</mat-label>

  <mat-select formControlName="departamento">
    <mat-option value="">Selecciona un departamento</mat-option>

    <ng-container *ngIf="departamentos?.length">
      <mat-option *ngFor="let dep of departamentos" [value]="dep.departamento_id">
        {{ dep.id }} - {{ dep.nombre }} (nivel: {{ dep.nivel }})
      </mat-option>
    </ng-container>
  </mat-select>
</mat-form-field>

    <!-- CategorÃ­a -->
    <mat-form-field appearance="fill" *ngIf="categorias.length > 0">
      <mat-label>ğŸ“ CategorÃ­a</mat-label>
      <mat-select formControlName="categoria">
        <mat-option value="">Selecciona una categorÃ­a</mat-option>
        <mat-option *ngFor="let cat of categorias" [value]="cat.id">{{ cat.nombre }}</mat-option>
      </mat-select>
    </mat-form-field>
    <!-- SubcategorÃ­a -->
    <mat-form-field appearance="fill" *ngIf="subcategorias.length > 0">
      <mat-label>ğŸ—‚ï¸ SubcategorÃ­a</mat-label>
      <mat-select formControlName="subcategoria">
        <mat-option value="">Selecciona una subcategorÃ­a</mat-option>
        <mat-option *ngFor="let sub of subcategorias" [value]="sub.id">{{ sub.nombre }}</mat-option>
      </mat-select>
    </mat-form-field>
    <!-- Detalle especÃ­fico -->
    <mat-form-field appearance="fill" *ngIf="detalles.length > 0">
      <mat-label>ğŸ“Œ Detalle especÃ­fico</mat-label>
      <mat-select formControlName="detalle">
        <mat-option value="">Selecciona un detalle</mat-option>
        <mat-option *ngFor="let det of detalles" [value]="det.id">{{ det.nombre }}</mat-option>
      </mat-select>
    </mat-form-field>
    <!-- Nivel de criticidad -->
    <mat-form-field appearance="fill">
      <mat-label>ğŸ”¥ Nivel de criticidad</mat-label>
      <mat-select formControlName="criticidad">
        <mat-option *ngFor="let nivel of nivelesCriticidad" [value]="nivel">
          Nivel {{ nivel }}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <!-- DescripciÃ³n -->
    <mat-form-field appearance="fill" class="w-full">
      <mat-label>ğŸ“ DescripciÃ³n del problema</mat-label>
      <textarea matInput formControlName="descripcion" rows="4" placeholder="Detalla lo ocurrido con claridad..."></textarea>
    </mat-form-field>
    <button mat-raised-button color="primary" type="submit" class="btn-submit"
      [disabled]="formularioCrearTicket.invalid || loading">
      <mat-icon>send</mat-icon> Crear Ticket
    </button>
  </form>
</mat-card>


<div style="background: #fff2; color: #222; font-size: 22px;">
  <b>TEST DE DEPARTAMENTOS:</b>
<div *ngFor="let dep of departamentos; let i = index">
  <b>{{ i }}:</b> {{ dep | json }}
</div>



<mat-form-field appearance="fill">
  <mat-label>ğŸ§ª Departamento Dummy</mat-label>
  <mat-select>
    <mat-option *ngFor="let dep of departamentosDummy" [value]="dep.departamento_id">
      {{ dep.nombre }} (nivel: {{ dep.nivel }})
    </mat-option>
  </mat-select>
</mat-form-field>